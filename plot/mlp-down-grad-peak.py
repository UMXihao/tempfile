import matplotlib.pyplot as plt

# 准备数据
x_3B = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]
x_7B = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]
x_13B =[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40]

# Orac-mini-7b
orac_squad = [2.828710556,3.693105698,20.73476028,3.346134424,3.983972788,26.2015152,7.341183186,4.028230667,3.681231499,3.526641369,2.934780359,2.825381279,2.969557285,3.027013063,3.132344961,3.311887503,3.098977566,3.194712877,3.14571166,3.529330492,2.777993441,2.7050035,2.644138575,5.062233925,13.60564327,6.531496048]
orac_human = [2.114317179,2.81964469,15.14116383,3.717904329,4.274976254,14.31669807,4.876971722,4.367607594,4.077774525,3.756533384,3.694734573,3.168257475,2.991127729,2.741035938,2.524398088,2.191411257,2.188722372,2.051900864,1.992317796,1.863176465,1.635028481,1.491367102,1.541322231,1.268924236,2.133562326,2.517280579]
orac_leval = [1.018051267,1.413890481,7.649412632,1.510473251,1.773756623,8.696953773,2.616369963,2.396814346,2.488417387,2.350079536,2.319010496,2.455883741,2.570932865,2.659776211,2.524212122,2.326835871,2.443037033,2.400454283,2.35785532,2.259550571,1.841011167,1.68588984,1.56377697,1.780890822,1.102864981,2.660254955]
# llama-2-7b
llama2_squad = [2.158285856,47.56196213,2.019146204,2.187242985,2.612125397,2.198868036,2.079209089,2.017631769,1.829916596,1.718256235,1.738614678,1.733260751,1.609779358,1.689873457,1.967872858,2.144301891,2.641048908,2.052549839,2.123777151,2.534819603,1.975168228,1.969681144,1.794150114,1.761492014,1.629718542,1.676641822,1.599323869,1.714984536,1.912741065,2.073814631,30.45705414,10.41917133]
llama2_human = [0.947417319,15.53196239,1.224878073,1.226696849,1.247061372,1.120850921,0.818275928,0.805368602,1.048214316,0.622434616,0.589221358,0.561399043,0.571805656,0.565781891,0.575436652,0.592146993,0.684243441,0.551990747,0.605109513,0.583545625,0.494162649,0.436878711,0.397335202,0.397278935,0.37614581,0.382283092,0.37070924,0.39726004,0.434845388,0.5208413,8.36736393,1.938635945]
llama2_leval = [0.077218808,1.778969049,0.16611217,0.173663914,0.188970193,0.189613715,0.200396925,0.201481372,0.19808583,0.191236123,0.193290368,0.1887656,0.1845496,0.189673305,0.187432617,0.194882914,0.211444736,0.207072899,0.207298905,0.203577206,0.210642904,0.204151526,0.199811146,0.184656501,0.178586274,0.171350986,0.164723694,0.158538967,0.155470476,0.160764903,0.402021199,0.414945394]
# MPT-7B
mpt_squad = [5.091772556,3.907046556,16.46999931,5.303633213,6.394834995,8.054897308,8.697392464,9.109886169,8.754551888,8.772591591,8.784472466,8.880475044,9.282811165,9.725057602,9.977891922,10.38008022,10.68528175,10.87352371,11.08026981,11.05897331,11.07866478,10.71813869,10.74128914,9.624519348,9.246968269,8.626493454,8.121801376,7.78276825,7.573647499,7.554637909,9.491134644,4.701910973]
mpt_human = [0.963164806,0.77412945,1.675003648,0.910500348,1.053707957,1.227602959,1.428205013,1.543028593,1.704403043,1.872430682,1.976149559,2.060580015,2.249860287,2.459215879,2.540498257,2.621758699,2.56840229,2.626863956,2.590049028,2.410496235,2.316411495,2.260548592,2.08024931,1.953639984,1.768353701,1.634640694,1.525726318,1.472076654,1.358926415,1.468656182,1.504912376,0.917463064]
mpt_leval = [0.388005883,0.269761205,0.425730228,0.366069257,0.437864393,0.523738384,0.591144621,0.658029914,0.735140562,0.805546403,0.884111106,0.909062088,1.040310025,1.119761825,1.148552656,1.389894247,1.102283478,1.121546745,1.066649199,1.009937286,0.977768123,0.961288631,0.949328542,0.894889653,0.803966701,0.724517345,0.698665023,0.653396428,0.598654211,0.622506618,0.592285514,0.320054531]
# llama-2-13B
llama_13b_squad = [13.28419304,8.768758774,3.553281069,48.43399811,3.50885725,3.766167402,3.446989059,3.527836084,3.062583447,2.754156351,2.563363791,2.618730783,2.552618742,2.594874382,2.600412369,2.9440341,2.85071969,2.903975725,3.047260523,3.074337482,2.810052395,3.076274872,2.921230555,2.92042613,2.73376298,2.630814791,2.622586966,2.555208206,2.464961052,2.360420227,2.378260851,2.330107212,2.236067057,2.266469955,2.128005981,2.088214397,2.353508949,2.498563051,5.115496159,4.231410503]
llama_13b_human = [12.99939346,11.96592426,1.170732737,24.58704185,2.376490116,1.95244503,1.882146716,1.714570403,1.599737525,1.552946091,1.429817319,1.549686193,1.364892483,1.407984614,1.45981276,1.419858336,1.45675981,1.421627522,1.382467389,1.317591429,1.237828612,1.31516993,1.253188014,1.173575282,1.097269058,1.019871831,1.000395417,0.956261039,0.915304065,0.894882441,0.869863868,0.871196389,0.897231519,0.910456419,0.928147316,0.99836874,1.055748582,1.163462162,1.45141983,1.442365646]
llama_13b_leval = [0.888162971,0.373214096,0.226336509,4.299430847,0.270589441,0.296338648,0.316108495,0.376073241,0.37398681,0.359223574,0.342730612,0.338067442,0.33844021,0.327309698,0.319553703,0.319696456,0.336481094,0.329652905,0.323662221,0.329448462,0.33061862,0.339765877,0.327217549,0.321833014,0.305161387,0.30616045,0.295980334,0.287351996,0.281230569,0.274164885,0.264561594,0.257386923,0.253585696,0.250960618,0.252372324,0.262236238,0.288986892,0.290604591,0.323353022,0.286500782]

# 创建一个画布
plt.figure(figsize=(20, 5))  # 设置画布大小，宽度为20英寸，高度为5英寸

# 绘制第一个折线图
plt.subplot(1, 4, 1)  # 表示一行三列的第1个位置
plt.plot(x_3B, orac_squad, label='SQuAD', color='blue', marker='o')  # 第一组数据
plt.plot(x_3B, orac_human, label='Human_Eval', color='red', marker='s')   # 第二组数据
plt.plot(x_3B, orac_leval, label='L-Eval', color='orange', marker='^')   # 第三组数据
plt.title('Orac-mini-3B', fontsize=24)  # 设置标题
plt.xlabel('Layer', fontsize=24)  # 设置X轴标签
plt.ylabel('Gradient', fontsize=24)  # 设置Y轴标签
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

# 绘制第二个折线图
plt.subplot(1, 4, 2)  # 表示一行三列的第2个位置
plt.plot(x_7B, llama2_squad, label='SQuAD', color='blue', marker='o')  # 第一组数据
plt.plot(x_7B, llama2_human, label='Human_Eval', color='red', marker='s') # 第二组数据
plt.plot(x_7B, llama2_leval, label='L-Eval', color='orange', marker='^')   # 第三组数据
plt.title('Llama-2-7B', fontsize=24)  # 设置标题
plt.xlabel('Layer', fontsize=24)  # 设置X轴标签
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

# 绘制第三个折线图
plt.subplot(1, 4, 3)  # 表示一行三列的第3个位置
plt.plot(x_7B, mpt_squad, label='SQuAD', color='blue', marker='o')  # 第一组数据
plt.plot(x_7B, mpt_human, label='Human_Eval', color='red', marker='s')   # 第二组数据
plt.plot(x_7B, mpt_leval, label='L-Eval', color='orange', marker='^')   # 第三组数据
plt.title('MPT-7B', fontsize=24)  # 设置标题
plt.xlabel('Layer', fontsize=24)  # 设置X轴标签
plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

# 绘制第四个折线图
plt.subplot(1, 4, 4)  # 表示一行三列的第3个位置
plt.plot(x_13B, llama_13b_squad, label='SQuAD', color='blue', marker='o')  # 第一组数据
plt.plot(x_13B, llama_13b_human, label='Human_Eval', color='red', marker='s')   # 第二组数据
plt.plot(x_13B, llama_13b_leval, label='L-Eval', color='orange', marker='^')   # 第三组数据
plt.title('Llama-2-13B', fontsize=24)  # 设置标题
plt.xlabel('Layer', fontsize=24)  # 设置X轴标签

plt.xticks(fontsize=20)
plt.yticks(fontsize=20)

# 添加图例
plt.legend(fontsize=20)

# 调整子图之间的间距
plt.tight_layout()

# 显示图形
# plt.show()
# plt.savefig('./pics/same-gradient-peak-layer.png', format='png')
plt.savefig('pics/same-gradient-peak-layer.pdf', format='pdf', bbox_inches='tight', pad_inches=0.26)
